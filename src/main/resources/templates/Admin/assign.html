<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymelef.org">

<head th:fragment="admin-header">

	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<title> Admin DashBoard</title>

	<!-- base:css -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
		integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
		crossorigin="anonymous" referrerpolicy="no-referrer" />

	<link rel="stylesheet" href="Admin/vendors/mdi/css/materialdesignicons.min.css">
	<link rel="stylesheet" href="Admin/vendors/feather/feather.css">
	<link rel="stylesheet" href="Admin/vendors/base/vendor.bundle.base.css">
	<!-- endinject -->

	<!-- plugin css for this page -->
	<link rel="stylesheet" href="Admin/vendors/flag-icon-css/css/flag-icon.min.css" />
	<link rel="stylesheet" href="Admin/vendors/font-awesome/css/font-awesome.min.css">
	<link rel="stylesheet" href="Admin/vendors/jquery-bar-rating/fontawesome-stars-o.css">
	<link rel="stylesheet" href="Admin/vendors/jquery-bar-rating/fontawesome-stars.css">
	<!-- End plugin css for this page -->
	<!-- inject:css -->

	<link rel="stylesheet" href="Admin/css/style.css">
	<!-- endinject -->
	<link rel="shortcut icon" href="Admin/images/favicon.png" />
</head>

<body>


	<!-- Topbar start -->
	<div class="container-scroller">

		<nav class="navbar col-lg-12 col-12 p-0 fixed-top d-flex flex-row">
			<div class="text-center navbar-brand-wrapper d-flex align-items-center justify-content-center">
			</div>
			<div class="navbar-menu-wrapper d-flex align-items-center justify-content-end">
				<button class="navbar-toggler navbar-toggler align-self-center" type="button" data-toggle="minimize">
					<span class="icon-menu"></span>
				</button>
				<ul class="navbar-nav mr-lg-2">
					<li class="nav-item nav-search d-none d-lg-block">
						<div class="input-group">
							<div class="input-group-prepend">
								<span class="input-group-text" id="search">
									<i class="icon-search"></i>
								</span>
							</div>
							<input type="text" class="form-control" placeholder="Search Projects.." aria-label="search"
								aria-describedby="search">
						</div>
					</li>
				</ul>
				<ul class="navbar-nav navbar-nav-right">

					<li class="nav-item dropdown d-flex">
						<a class="nav-link count-indicator dropdown-toggle d-flex justify-content-center align-items-center"
							id="messageDropdown" href="#" data-toggle="dropdown">
							<i class="icon-air-play mx-0"></i>
						</a>
						<div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list"
							aria-labelledby="messageDropdown">
							<p class="mb-0 font-weight-normal float-left dropdown-header">Messages</p>
							<a class="dropdown-item preview-item">
								<div class="preview-thumbnail">
									<img src="Admin/images/faces/face4.jpg" alt="image" class="profile-pic">
								</div>
								<div class="preview-item-content flex-grow">
									<h6 class="preview-subject ellipsis font-weight-normal">David Grey
									</h6>
									<p class="font-weight-light small-text text-muted mb-0">
										The meeting is cancelled
									</p>
								</div>
							</a>


						</div>
					</li>

					<li class="nav-item dropdown d-flex mr-4 ">
						<a class="nav-link count-indicator dropdown-toggle d-flex align-items-center justify-content-center"
							id="notificationDropdown" href="#" data-toggle="dropdown">
							<i class="icon-cog"></i>
						</a>
						<div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list"
							aria-labelledby="notificationDropdown">
							<p class="mb-0 font-weight-normal float-left dropdown-header">Settings</p>
							<a class="dropdown-item preview-item">
								<i class="icon-head"></i> Profile
							</a>
							<a class="dropdown-item preview-item">
								<i class="icon-inbox"></i> Logout
							</a>
						</div>
					</li>
					<li class="nav-item dropdown mr-4 d-lg-flex d-none">
						<a class="nav-link count-indicatord-flex align-item s-center justify-content-center" href="#">
							<i class="icon-grid"></i>
						</a>
					</li>
				</ul>
				<button class="navbar-toggler navbar-toggler-right d-lg-none align-self-center" type="button"
					data-toggle="offcanvas">
					<span class="icon-menu"></span>
				</button>
			</div>
		</nav>


		<!-- Topbar End -->


		<!-- partial -->

		<div class="container-fluid page-body-wrapper">
			<!-- partial:partials/_sidebar.html -->


			<!--########################## ...th:replace fragment... ##########################-->

			<div class="sidebar" th:replace="Admin/index :: admin-sidebar"></div>



			<!-- partial -->

			<body onload="getAssignData()">

				<div class="main-panel">
					<div class="content-wrapper">
						<div class="col-sm-6">
							<h1 class="text-success"><b>Assign Meetings</b></h1>
						</div>
						<!-- <div class="row">
			  <h1 class="text-white bg-dark text-center">EMPLOYEE DATA</h1>
			  <br>
           <li class="nav-item dropdown d-lg-flex d-none">
                <button type="button" class="btn btn-info font-weight-bold" data-toggle="modal" data-target="#addbtn">ADD EMPLOYEE</button>
            </li>
             <ul class="navbar-nav navbar-nav-right">
          </div>-->
						<div class="input-group">
							<input type="text" id="searchInput" placeholder="Search Name" aria-label="search" aria-describedby="search">
							<div class="input-group-append">
								<button id="searchButton" class="btn btn-info btn-rounded btn-fw" type="button"> <i class="fas fa-search"></i></button>
							</div>
						</div>

						<div class="table-responsive pt-3">

							<table class="table table-bordered table-dark">
								<thead>
									<tr>

										<!--	<th>$</th>   -->
										<th>EMPLOYEE NAME</th>
										<th>EMPLOYEE EMAIL</th>
										<th>VISITOR NAME</th>
										<th>VISITOR EMAIL</th>
										<th>VISITOR REASON</th>
										<th>TIMESTAMP</th>
										<th>STATUS</th>
										<th>ACTION</th>
									</tr>
								</thead>

								<tbody id="Table">
								</tbody>
							</table>
						</div>

						<!--^^^^^^^^^^^^^^^  Model Start ADD Employee ^^^^^^^^^^^^^^-->



						<!-- model end -->
						<!-- Boostrap Lib -->
						<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
							integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
							crossorigin="anonymous"></script>
						<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
							integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
							crossorigin="anonymous"></script>
						<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
							integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
							crossorigin="anonymous"></script>
						<!-- AjAX lib -->

						<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js"> </script>

					</div>
					<!-- main center page end -->

					<!-- you can put another card here -->

				</div>

		</div>
		<!-- main-panel ends -->
	</div>
	<!-- page-body-wrapper ends -->
	</div>

	<script>

		$(document).ready(function () {
			getAssignData;

			 $('#searchInput').on('input', function () {
    SearchData();
  });


		});


		function getAssignData() {
			//alert('call jara...');

			$.ajax({
				method: "GET",
				url: "/assignAll",
				success: function (data) {
					var html = '';

					for (var i = 0; i < data.length; i++) {
						html += '<tr>'
							+ '<td>' + data[i].employeename + '</td>'
							+ '<td>' + data[i].employeeemail + '</td>'
							+ '<td>' + data[i].visitorname + '</td>'
							+ '<td>' + data[i].visitoremail + '</td>'
							+ '<td>' + data[i].reason + '</td>'
							+ '<td>' + data[i].timestamp + '</td>'
							+ '<td>' + '<a class="fa-solid fa-square-check fa-lg"  onclick="ApproveMeet(' + data[i].id + ')" style="font-size:2em"></a> <a class="fa-solid fa-square-xmark fa-lg"  onclick="RejectMeet(' + data[i].id + ')"  style="font-size:2em"></a> <span  class="badge bg-success text-center" style="font-size:small"> ' + data[i].status + '</td>'

							+ '<td>' + '<a id="delete"  onclick="deleteAssign(' + data[i].id + ')" class="delete btn btn-danger" ><i class="fa fa-trash" aria-hidden="true"></i></a>'
							+ '</td>'
						'</tr>';

					}
					$('#Table').html(html);


				},
				error: function () {
					alert("not working");
				}
			});
		}
	

		//delete assign
		function deleteAssign(id) {
			//alert('Assign delete successfully..'+employeeid)

			$.ajax({
				method: "DELETE",
				contentType: "application/json",
				url: '/deleteAssignmeet/' + id,
				//data: {id: id},
				success: function (response) {
					getAssignData();
					toastr.error('Meeting delete success..');


				},
				/*	error: function () {
	
						alert("can not delete");
					}   */
			});
		}


		function ApproveMeet(id)
		 {
			//alert('showww');

			$.ajax({
				method: "POST",
				url: "/approveMeeting/" + id,
				success: function (data) {
					getAssignData();
					swal("Approved!", "The meeting has been approved.", "success");


				},
				error: function () {
					swal("Error", "Failed to approve the meeting.", "error");
				},
			});
		}

		function RejectMeet(id) {
			$.ajax({
				method: "POST",
				url: "/rejectMeeting/" + id,
				success: function (data) {
					getAssignData();
					swal("Rejected!", "The Meeting has been Rejected.", "error");
				},
				error: function () {
					swal("Error", "Failed to reject the meeting.", "error");
				},
			});
		}


	function SearchData() 
	{
    var searchQuery = $('#searchInput').val().trim().toLowerCase();

    $('#Table tr').each(function () 
    {
      var employeeName = $(this).find('td:eq(0)').text().toLowerCase();
	      if (employeeName.includes(searchQuery))
       {
        $(this).show();
      } else {
        $(this).hide();
      }
    });
  }




	</script>

	<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>


	<link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css" rel="stylesheet">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>




	<!-- base:js -->
	<!--<script src="vendors/base/vendor.bundle.base.js"></script> -->
	<!-- endinject -->
	<!-- Plugin js for this page-->
	<!-- End plugin js for this page-->
	<!-- inject:js -->
	<script src="Admin/js/off-canvas.js"></script>
	<script src="Admin/js/hoverable-collapse.js"></script>
	<script src="Admin/js/template.js"></script>
	<!-- endinject -->
	<!-- plugin js for this page -->
	<script src="Admin/vendors/jquery-bar-rating/jquery.barrating.min.js"></script>
	<!-- End plugin js for this page -->
	<!-- Custom js for this page-->
	<script src="Admin/js/dashboard.js"></script>
	<!-- End custom js for this page-->
</body>

</html>